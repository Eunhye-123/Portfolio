*&---------------------------------------------------------------------*
*& Include ZBBUR0010_TOP                            - Report ZBBUR0010
*&---------------------------------------------------------------------*
REPORT ZBBUR0010 MESSAGE-ID ZM23.

TABLES : ZBBUT0010, ZBMDT0030, SSCRFIELDS.

DATA : OK_CODE TYPE SY-UCOMM.

*광역변수 선언
DATA : BEGIN OF GS_TAB.
            INCLUDE STRUCTURE ZBBUT0010.
DATA:   PMONEY TYPE ZBMDT0030-PMONEY,
            CELL TYPE LVC_T_STYL,
            END OF GS_TAB,
            GT_TAB LIKE TABLE OF GS_TAB WITH NON-UNIQUE KEY PCODE,
            GS_OTAB LIKE GS_TAB,
            GT_OTAB LIKE GT_TAB.

DATA : LT_EXCLUDE TYPE TABLE OF RSEXFCODE,
            LS_EXCLUDE TYPE RSEXFCODE.
DATA : GT_FILE TYPE FILETABLE,
            GV_RC   TYPE I.

DATA : G_FUNCTIONKEY TYPE SMP_DYNTXT.

*엑셀 업로드 관련****
DATA : GT_EXCEL TYPE TABLE OF ALSMEX_TABLINE,
            GS_EXCEL TYPE ALSMEX_TABLINE.

FIELD-SYMBOLS : <FS>.

"상수
CONSTANTS : C_FILTER TYPE STRING VALUE
'EXCEL FILES (*.XLSX)|*.XLSX|EXCEL FILES (*.XLS)|*.XLS|'.


"ALV 관련 변수
DATA : G_CONT TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
            G_GRID1 TYPE REF TO CL_GUI_ALV_GRID.

DATA : GS_FIELDCAT TYPE LVC_S_FCAT,
            GT_FIELDCAT TYPE LVC_T_FCAT,
            GS_LAYO       TYPE LVC_S_LAYO,
            GS_SORT       TYPE LVC_S_SORT,
            GT_SORT       TYPE LVC_T_SORT,
            LV_LINES       TYPE C,
            GT_FUNCTIONS TYPE UI_FUNCTIONS,
            GS_POS         TYPE I.


DATA : GS_LAYOUT      TYPE LVC_S_LAYO,
            GS_LAYOUT2    TYPE LVC_S_LAYO,
            GS_LAYOUT3    TYPE LVC_S_LAYO,
            GS_PRINT         TYPE LVC_S_PRNT,
            GS_ROWS         TYPE LVC_S_ROW,
            GS_F4               TYPE LVC_S_F4,
            GS_STYLE          TYPE LVC_S_STYL,
            GS_COLOR        TYPE LVC_S_SCOL,
            GS_STABLE        TYPE LVC_S_STBL VALUE 'XX',
            GS_VARIANT     TYPE DISVARIANT,
            GS_VARIANT2   TYPE DISVARIANT,
            GS_VARIANT3   TYPE DISVARIANT,
            GS_COL             TYPE LVC_S_COL.


"화면 설계

* 엑셀 업로드 버튼 클릭 시 보여지는 화면 (디폴트)
SELECTION-SCREEN BEGIN OF BLOCK B1 WITH FRAME TITLE TEXT-001.
PARAMETERS P_FILE TYPE LOCALFILE MODIF ID IN1.
SELECTION-SCREEN END OF BLOCK B1.

* 개별 입력 버튼 클릭 시 보여지는 화면
SELECTION-SCREEN BEGIN OF BLOCK B3 WITH FRAME TITLE TEXT-002.
SELECT-OPTIONS : P_CODE FOR ZBMDT0030-PCODE NO INTERVALS NO-EXTENSION MODIF ID IN2.
PARAMETERS : P_NO TYPE ZBBUT0030-EMSEQ MODIF ID IN2 NO-DISPLAY.
PARAMETERS : P_DATE TYPE ZBMDT0030-SDATE MODIF ID IN2 OBLIGATORY DEFAULT SY-DATUM.
*                              P_PRICE FOR ZBBUT0010-PROBUD NO INTERVALS NO-EXTENSION MODIF ID IN2,
SELECT-OPTIONS : P_EMPNO FOR ZBBUT0010-EMPNO NO INTERVALS NO-EXTENSION MODIF ID IN2.
PARAMETERS : P_PRICE TYPE ZBMDT0030-PMONEY MODIF ID IN2 .
PARAMETERS : P_BUDGET TYPE ZBBUT0010-PROBUD MODIF ID IN2.
PARAMETERS : P_SDATE TYPE ZBMDT0030-SDATE MODIF ID IN2 NO-DISPLAY,
                     P_EDATE TYPE ZBMDT0030-EDATE MODIF ID IN2 NO-DISPLAY.
SELECTION-SCREEN END OF BLOCK B3.


* 라디오 버튼
SELECTION-SCREEN BEGIN OF BLOCK B2 WITH FRAME TITLE TEXT-003.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 1(10) TEXT-004.
PARAMETERS RA1 RADIOBUTTON GROUP RG1 DEFAULT 'X' USER-COMMAND RA.
SELECTION-SCREEN COMMENT 25(10) TEXT-005 FOR FIELD RA1.
PARAMETERS RA2 RADIOBUTTON GROUP RG1.
SELECTION-SCREEN COMMENT 40(10) TEXT-006 FOR FIELD RA2.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK B2.

SELECTION-SCREEN : FUNCTION KEY 1, FUNCTION KEY 2.


"클래스 이벤트 정의
CLASS LCL_EVENT DEFINITION.
  PUBLIC SECTION.
    METHODS HANDLE_TOOLBAR
          FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
      IMPORTING
          E_OBJECT E_INTERACTIVE.

    METHODS HANDLER_USER_COMMAND
          FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
      IMPORTING
          E_UCOMM.
ENDCLASS.

CLASS LCL_EVENT IMPLEMENTATION.
  METHOD HANDLE_TOOLBAR.
    PERFORM TOOLBAR_0100 USING E_OBJECT E_INTERACTIVE.
  ENDMETHOD.

  METHOD HANDLER_USER_COMMAND.
    PERFORM USER_COMMAND_0100 USING E_UCOMM.
  ENDMETHOD.

ENDCLASS.

DATA: G_APPLI TYPE REF TO LCL_EVENT.

----------------------------------------------------------------------------------
Extracted by Direct Download Enteprise version 1.0 - E.G.Mellodew. 1998-2003 UK.
